{"nbformat":4,"nbformat_minor":0,"metadata":{"accelerator":"GPU","colab":{"name":"“7_3_SequenceClassification.ipynb”的副本","provenance":[{"file_id":"https://github.com/ecs-vlc/COMP6248/blob/master/docs/labs/lab7/7_3_SequenceClassification.ipynb","timestamp":1618767150426}]},"kernelspec":{"display_name":"Python 3","language":"python","name":"python3"},"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.6.7"},"widgets":{"application/vnd.jupyter.widget-state+json":{"93b86582d76447af830fb1dfbd770de6":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_72b181dccd00427b89b59e103772bbc6","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_0d02dc369bd443a2973eaa6581db72f5","IPY_MODEL_198bad2aad8844d5b498a510fcdfd3cf"]}},"72b181dccd00427b89b59e103772bbc6":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"0d02dc369bd443a2973eaa6581db72f5":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_692c78a212ba4e3792fa764a1aba34af","_dom_classes":[],"description":"0/5(t): 100%","_model_name":"FloatProgressModel","bar_style":"success","max":274,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":274,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_1d268bede55f41428b9f542b2ed9b966"}},"198bad2aad8844d5b498a510fcdfd3cf":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_562c400fa2b747709ec3a4262519ecd7","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 274/274 [20:22&lt;00:00,  4.46s/it, binary_acc=0.5031, loss=0.6989, running_binary_acc=0.4997, running_loss=0.6979]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_9ef6c145a998473f83e3cdcb5f5e9c8c"}},"692c78a212ba4e3792fa764a1aba34af":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"1d268bede55f41428b9f542b2ed9b966":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"562c400fa2b747709ec3a4262519ecd7":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"9ef6c145a998473f83e3cdcb5f5e9c8c":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"0bb72d40c03348bd8cc276a95900c733":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_d36523f856814ed4828c48f24f99ee16","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_cce85deac7e44f8eb67dae51f49211d4","IPY_MODEL_98c63e32fd114abd82fe71a9fae3b851"]}},"d36523f856814ed4828c48f24f99ee16":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"cce85deac7e44f8eb67dae51f49211d4":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_09fda00619f3406d9a576a1da5e25237","_dom_classes":[],"description":"0/5(v): 100%","_model_name":"FloatProgressModel","bar_style":"success","max":118,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":118,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_514cd2c552d74ac1b3f8ecec0a7c7785"}},"98c63e32fd114abd82fe71a9fae3b851":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_379dab05524f48b2bdf5cc44ad93a64e","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 118/118 [00:09&lt;00:00, 12.68it/s, val_binary_acc=0.4955, val_loss=0.6983]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_2c90a20daa9148bb837a39f75754c09f"}},"09fda00619f3406d9a576a1da5e25237":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"514cd2c552d74ac1b3f8ecec0a7c7785":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"379dab05524f48b2bdf5cc44ad93a64e":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"2c90a20daa9148bb837a39f75754c09f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"d878db33e9af4ef58578779f883336da":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_8594eabd7f834ec697135c0bda936077","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_073297ff6b514e2d8f027a7511c7fcdc","IPY_MODEL_98f651b13c8c497094dbaf4f2abe3613"]}},"8594eabd7f834ec697135c0bda936077":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"073297ff6b514e2d8f027a7511c7fcdc":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_b87f49c91216474782f985af118695e2","_dom_classes":[],"description":"1/5(t): 100%","_model_name":"FloatProgressModel","bar_style":"success","max":274,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":274,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_0eea6b9bb61b4e2ea03128179be74238"}},"98f651b13c8c497094dbaf4f2abe3613":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_65ac1f22bf654f6fa26f2456c3c40bb9","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 274/274 [20:14&lt;00:00,  4.43s/it, binary_acc=0.5031, loss=0.699, running_binary_acc=0.5091, running_loss=0.7019]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_a7e3e40ac6f4420ea1db3764e28021b4"}},"b87f49c91216474782f985af118695e2":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"0eea6b9bb61b4e2ea03128179be74238":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"65ac1f22bf654f6fa26f2456c3c40bb9":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"a7e3e40ac6f4420ea1db3764e28021b4":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"275c78605231495fb60418b7dcd4636e":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_1d2d880d25774da79d136b09132b262c","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_51f7c7e483e74c74bdcd212dae0207fe","IPY_MODEL_6b639291dbcc4dd3905c4df716146172"]}},"1d2d880d25774da79d136b09132b262c":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"51f7c7e483e74c74bdcd212dae0207fe":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_10358a03430047df9ef0e84da38e4c12","_dom_classes":[],"description":"1/5(v): 100%","_model_name":"FloatProgressModel","bar_style":"success","max":118,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":118,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_768d74ef0a7b490494cfd05ee68244a3"}},"6b639291dbcc4dd3905c4df716146172":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_d76656297d4249f5a1d32435766a32a7","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 118/118 [20:07&lt;00:00, 10.23s/it, val_binary_acc=0.4955, val_loss=0.6983]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_4b788ed0ce234a8f99128cbd39f3dc44"}},"10358a03430047df9ef0e84da38e4c12":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"768d74ef0a7b490494cfd05ee68244a3":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"d76656297d4249f5a1d32435766a32a7":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"4b788ed0ce234a8f99128cbd39f3dc44":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"b320ee4d75a245e3be06ddf25d6a7973":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_38da2b4b1f9842809ce27863e7ae0c57","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_07f4777362714f4fa56bb86b19dcced5","IPY_MODEL_5538c06b06654e608222a77611a352ba"]}},"38da2b4b1f9842809ce27863e7ae0c57":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"07f4777362714f4fa56bb86b19dcced5":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_2ded6d1add9e4efa8ea68d628cbf89da","_dom_classes":[],"description":"2/5(t): 100%","_model_name":"FloatProgressModel","bar_style":"success","max":274,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":274,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_35a4bd4917204ce7b32d4e7e49f2a7e6"}},"5538c06b06654e608222a77611a352ba":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_137fb0b8944343bea81ec02a0a449d58","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 274/274 [20:05&lt;00:00,  4.40s/it, binary_acc=0.5031, loss=0.699, running_binary_acc=0.502, running_loss=0.6987]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_a13285e3b3cf4a1ba9625e14e76c7eee"}},"2ded6d1add9e4efa8ea68d628cbf89da":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"35a4bd4917204ce7b32d4e7e49f2a7e6":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"137fb0b8944343bea81ec02a0a449d58":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"a13285e3b3cf4a1ba9625e14e76c7eee":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"e313d3aa1f584bcf94f22912c19e3657":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_39bbf21ad4ce4797acab1cfe1ce61cb3","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_8e52b64ea71c498d8981b3611f76ddb0","IPY_MODEL_975eec76bb374ca998e46d218cd17302"]}},"39bbf21ad4ce4797acab1cfe1ce61cb3":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"8e52b64ea71c498d8981b3611f76ddb0":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_0a7a0b2369044a679295cf978fed1ca2","_dom_classes":[],"description":"2/5(v): 100%","_model_name":"FloatProgressModel","bar_style":"success","max":118,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":118,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_6663db58ff1b4c46b43f3ea10769f54d"}},"975eec76bb374ca998e46d218cd17302":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_62f72b2e197a482b92d8027bf2cd9da6","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 118/118 [00:02&lt;00:00, 46.44it/s, val_binary_acc=0.4955, val_loss=0.6983]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_7b1b03e835394f4896532ffca6fae0e6"}},"0a7a0b2369044a679295cf978fed1ca2":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"6663db58ff1b4c46b43f3ea10769f54d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"62f72b2e197a482b92d8027bf2cd9da6":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"7b1b03e835394f4896532ffca6fae0e6":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"cdce4888bfb4412a8e092b3e59460556":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_9f1f7567db5b4b21bfd3fba7f2882e60","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_9557f6f1d9904f93aaa9bf52fae42869","IPY_MODEL_22a6396a477d4bb1bf0339d6a25336b6"]}},"9f1f7567db5b4b21bfd3fba7f2882e60":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"9557f6f1d9904f93aaa9bf52fae42869":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_b3c080ee51d7483b8b6e16f462b92d1e","_dom_classes":[],"description":"3/5(t): 100%","_model_name":"FloatProgressModel","bar_style":"success","max":274,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":274,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_e9c8235706574cd4acfcb604f2e3b755"}},"22a6396a477d4bb1bf0339d6a25336b6":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_a35026d68ef24ff19be4464a96b5be35","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 274/274 [19:57&lt;00:00,  4.37s/it, binary_acc=0.5031, loss=0.699, running_binary_acc=0.5084, running_loss=0.6985]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_9da44a72f33a4bc1b034ab81a9a5dfbb"}},"b3c080ee51d7483b8b6e16f462b92d1e":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"e9c8235706574cd4acfcb604f2e3b755":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"a35026d68ef24ff19be4464a96b5be35":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"9da44a72f33a4bc1b034ab81a9a5dfbb":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"2ce1ef835fd247df9da72cce437488e0":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_7f6b0448ed2a4291b32bed7a59d66f8c","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_7bdbe5ec6dc9496ca5aa7c91d1cd6821","IPY_MODEL_d97b41dd06724a86b1d144089c09fadd"]}},"7f6b0448ed2a4291b32bed7a59d66f8c":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"7bdbe5ec6dc9496ca5aa7c91d1cd6821":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_bd9214fab4814628bf6d4f5d58d875a7","_dom_classes":[],"description":"3/5(v): 100%","_model_name":"FloatProgressModel","bar_style":"success","max":118,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":118,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_25770c6adc6f456291c3d75812abb6d0"}},"d97b41dd06724a86b1d144089c09fadd":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_bf2ca19442f74e0e8eaf9c3b250d01fb","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 118/118 [00:08&lt;00:00, 13.21it/s, val_binary_acc=0.4955, val_loss=0.6983]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_e349e34141bc40dfbae6218056214a7a"}},"bd9214fab4814628bf6d4f5d58d875a7":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"25770c6adc6f456291c3d75812abb6d0":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"bf2ca19442f74e0e8eaf9c3b250d01fb":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"e349e34141bc40dfbae6218056214a7a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"b42f6747b3d24eaf91817692c7f67629":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_af53699b9c2f462ba6d12e5a91155b14","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_ab7348af26d647ebb5cfb1f74bd26142","IPY_MODEL_2b1f161cb84840d1b2d8d17c965f86cd"]}},"af53699b9c2f462ba6d12e5a91155b14":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"ab7348af26d647ebb5cfb1f74bd26142":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_a4260cf266c349d9962c97e5de71c0cf","_dom_classes":[],"description":"4/5(t): 100%","_model_name":"FloatProgressModel","bar_style":"success","max":274,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":274,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_fca50de6f7a14e079ef29091eaa37c3e"}},"2b1f161cb84840d1b2d8d17c965f86cd":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_a1f10e45ce2b40689dbe628db402915e","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 274/274 [19:48&lt;00:00,  4.34s/it, binary_acc=0.5031, loss=0.699, running_binary_acc=0.4972, running_loss=0.7004]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_9afd55b1d20742458e550cbb52e38223"}},"a4260cf266c349d9962c97e5de71c0cf":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"fca50de6f7a14e079ef29091eaa37c3e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"a1f10e45ce2b40689dbe628db402915e":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"9afd55b1d20742458e550cbb52e38223":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"bbcf49db00c84c5383ec1bd8aec8b535":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_c90b104d82294447a5fbcd7714d408d2","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_a9919dcbe3f04cb39d5d9aacb16ce5b0","IPY_MODEL_1c61c5cf65b34a1194bb40eaf19e8a15"]}},"c90b104d82294447a5fbcd7714d408d2":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"a9919dcbe3f04cb39d5d9aacb16ce5b0":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_0efb4e8a330642c2a38fda71df5e8ed4","_dom_classes":[],"description":"4/5(v): 100%","_model_name":"FloatProgressModel","bar_style":"success","max":118,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":118,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_87ac4ebf520146bfa8a787021c3fdc5e"}},"1c61c5cf65b34a1194bb40eaf19e8a15":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_453f2f039e6e45c594253941eb34043e","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 118/118 [19:42&lt;00:00, 10.02s/it, val_binary_acc=0.4955, val_loss=0.6983]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_6c8ccab359a64c2d955d06812bea3edb"}},"0efb4e8a330642c2a38fda71df5e8ed4":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"87ac4ebf520146bfa8a787021c3fdc5e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"453f2f039e6e45c594253941eb34043e":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"6c8ccab359a64c2d955d06812bea3edb":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"cad20b7d680b4660b7a506db5409982e":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_435f4845676b46a3b48fec3c776da289","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_66289bd8eab548958fab1124ce1100a6","IPY_MODEL_eb42354fd9224d6b88817b0350faaa3d"]}},"435f4845676b46a3b48fec3c776da289":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"66289bd8eab548958fab1124ce1100a6":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_008a03cbe74f495194b78447c4b4c52a","_dom_classes":[],"description":"0/1(p): 100%","_model_name":"FloatProgressModel","bar_style":"success","max":391,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":391,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_52b9ecbf6ea244a485db9e7ed9d6a01a"}},"eb42354fd9224d6b88817b0350faaa3d":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_41b06b7964d845f89bc31cb3a05ca8e5","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 391/391 [19:40&lt;00:00,  3.02s/it, test_binary_acc=0.4999, test_loss=0.6986]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_773f54cf71e24517a5fc8c8e9c76296b"}},"008a03cbe74f495194b78447c4b4c52a":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"52b9ecbf6ea244a485db9e7ed9d6a01a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"41b06b7964d845f89bc31cb3a05ca8e5":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"773f54cf71e24517a5fc8c8e9c76296b":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"bed5b132bddb4b568d19e52fa00f1d21":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_fca982c910e84b75b596631e9d398fe8","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_5ad9e9e9db124ed6bf75e829b882e096","IPY_MODEL_4babc0002ce145f5a30418983b841243"]}},"fca982c910e84b75b596631e9d398fe8":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"5ad9e9e9db124ed6bf75e829b882e096":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_23630359eb8140e7a49450b92be88579","_dom_classes":[],"description":"0/5(t): 100%","_model_name":"FloatProgressModel","bar_style":"success","max":274,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":274,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_7d47bec079d44a4090d27bbd6371e2a9"}},"4babc0002ce145f5a30418983b841243":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_9d7c0091026d455e8af6560e0f002502","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 274/274 [01:18&lt;00:00,  3.51it/s, binary_acc=0.6593, loss=0.5639, running_binary_acc=0.8253, running_loss=0.3667]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_a09632c77d0f44bda2491cf4ba7da3f1"}},"23630359eb8140e7a49450b92be88579":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"7d47bec079d44a4090d27bbd6371e2a9":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"9d7c0091026d455e8af6560e0f002502":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"a09632c77d0f44bda2491cf4ba7da3f1":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"1abf13dc6fe1499f9b344f0294c7c5d4":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_92f24d64cb4f4861bd96ff263b7dfa41","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_b58f06e5badb446fb8c97adb23c1da1e","IPY_MODEL_fece65c6a132454e8dd761ecfaecfb5c"]}},"92f24d64cb4f4861bd96ff263b7dfa41":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"b58f06e5badb446fb8c97adb23c1da1e":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_25eef5dfeade471ebd36f32f4ff7150e","_dom_classes":[],"description":"0/5(v): 100%","_model_name":"FloatProgressModel","bar_style":"success","max":118,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":118,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_9c1f2383354048acbfe9dae36736b2ce"}},"fece65c6a132454e8dd761ecfaecfb5c":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_a638ea0b3c0d40059cbac8d79a424b56","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 118/118 [00:09&lt;00:00, 12.49it/s, val_binary_acc=0.8081, val_loss=0.3797]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_02fb907c303e49f493f1f87952dab4b4"}},"25eef5dfeade471ebd36f32f4ff7150e":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"9c1f2383354048acbfe9dae36736b2ce":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"a638ea0b3c0d40059cbac8d79a424b56":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"02fb907c303e49f493f1f87952dab4b4":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"a63aed56179d461680177cb9a974fe19":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_12af9089041e4685b8dcf99461f0531f","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_c01612bde1604f169ae5ee0d893f5fa0","IPY_MODEL_d9dc47fd75fd4980bc67e6f562864eb3"]}},"12af9089041e4685b8dcf99461f0531f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"c01612bde1604f169ae5ee0d893f5fa0":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_1a463b7630164911a0c337adf5dbf678","_dom_classes":[],"description":"1/5(t): 100%","_model_name":"FloatProgressModel","bar_style":"success","max":274,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":274,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_97658862c8f5477380294312cb4ff988"}},"d9dc47fd75fd4980bc67e6f562864eb3":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_58444e81cb99436fa63a8f2ea9a58e3b","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 274/274 [00:07&lt;00:00, 36.34it/s, binary_acc=0.9075, loss=0.2206, running_binary_acc=0.9131, running_loss=0.2144]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_426d87fb89c14d7a832b867b852deffa"}},"1a463b7630164911a0c337adf5dbf678":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"97658862c8f5477380294312cb4ff988":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"58444e81cb99436fa63a8f2ea9a58e3b":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"426d87fb89c14d7a832b867b852deffa":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"23a24ed3d88944a2a941798f075fc061":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_cc21ee0070b64007bb6b54155343820a","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_be0ff407253c4e9fa35aac801a89232c","IPY_MODEL_5fc0f1ab87ea4a4d92f9d49e2932d982"]}},"cc21ee0070b64007bb6b54155343820a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"be0ff407253c4e9fa35aac801a89232c":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_39cc0054452643df8db7fed02b6f3b09","_dom_classes":[],"description":"1/5(v): 100%","_model_name":"FloatProgressModel","bar_style":"success","max":118,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":118,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_07a32c5fba4342a78c423d1cf34aae34"}},"5fc0f1ab87ea4a4d92f9d49e2932d982":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_e1aaed538123409a86eb48c713f97841","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 118/118 [01:02&lt;00:00,  1.89it/s, val_binary_acc=0.8721, val_loss=0.2912]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_aef489c2dc0c4052be02bc7e2d923d3b"}},"39cc0054452643df8db7fed02b6f3b09":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"07a32c5fba4342a78c423d1cf34aae34":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"e1aaed538123409a86eb48c713f97841":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"aef489c2dc0c4052be02bc7e2d923d3b":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"66d47f229a27458a89ec5571fe1d08dd":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_bf4707139bf54c709d0c7650cee11adc","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_db31cb912df744ac835e4fbcac40b138","IPY_MODEL_1d2300d0aac947a49c502a0ce2a04acd"]}},"bf4707139bf54c709d0c7650cee11adc":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"db31cb912df744ac835e4fbcac40b138":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_349ac33d169a4f54bf3b6aaa7bee98d9","_dom_classes":[],"description":"2/5(t): 100%","_model_name":"FloatProgressModel","bar_style":"success","max":274,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":274,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_1183317076cb4595b3fc89d0e8742e65"}},"1d2300d0aac947a49c502a0ce2a04acd":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_0c7fe5767ec645269d040e832fb3c32d","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 274/274 [00:09&lt;00:00, 30.39it/s, binary_acc=0.9688, loss=0.083, running_binary_acc=0.9674, running_loss=0.0875]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_10d043b2c7644baf9805be850a29ac8b"}},"349ac33d169a4f54bf3b6aaa7bee98d9":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"1183317076cb4595b3fc89d0e8742e65":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"0c7fe5767ec645269d040e832fb3c32d":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"10d043b2c7644baf9805be850a29ac8b":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"9aca671b244b4ab8af0c76c065f38e0c":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_bcead4c069c94347b1f79b6a9a26ca67","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_074c59d7c92f411588b6489e082f17c3","IPY_MODEL_31f3610803ca41b7b8b36a91bdbdd0a9"]}},"bcead4c069c94347b1f79b6a9a26ca67":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"074c59d7c92f411588b6489e082f17c3":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_c5dea59def2d4f5e91ed3aba5b34ec00","_dom_classes":[],"description":"2/5(v): 100%","_model_name":"FloatProgressModel","bar_style":"success","max":118,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":118,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_eb6b3452f74042bbbaa328ec1486d83e"}},"31f3610803ca41b7b8b36a91bdbdd0a9":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_5649c6f5f68744abb37e8cb8d7d5c43a","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 118/118 [00:53&lt;00:00,  2.21it/s, val_binary_acc=0.8853, val_loss=0.3279]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_3bbbfe134d374cbe9b6948b70b2e8763"}},"c5dea59def2d4f5e91ed3aba5b34ec00":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"eb6b3452f74042bbbaa328ec1486d83e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"5649c6f5f68744abb37e8cb8d7d5c43a":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"3bbbfe134d374cbe9b6948b70b2e8763":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"cb54d0dee32842c99fb9235b87077a06":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_c42dc1a6614049308ac068053f97797d","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_9873f08a374c431ead91345caf9ffe89","IPY_MODEL_27e290b459b84d1bb11aa49cb4c841fd"]}},"c42dc1a6614049308ac068053f97797d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"9873f08a374c431ead91345caf9ffe89":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_012a3e79a4c34f00b8e6131b3b1ab52d","_dom_classes":[],"description":"3/5(t): 100%","_model_name":"FloatProgressModel","bar_style":"success","max":274,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":274,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_3feaada9eaf34afeafef5a659740fc1d"}},"27e290b459b84d1bb11aa49cb4c841fd":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_ff4a52f9fdd748218541c6b6453e7b9c","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 274/274 [00:51&lt;00:00,  5.32it/s, binary_acc=0.9898, loss=0.0285, running_binary_acc=0.9844, running_loss=0.0376]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_e8b339ddaa774c8c909897cc6d95a239"}},"012a3e79a4c34f00b8e6131b3b1ab52d":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"3feaada9eaf34afeafef5a659740fc1d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"ff4a52f9fdd748218541c6b6453e7b9c":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"e8b339ddaa774c8c909897cc6d95a239":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"8c177a741ab04f88b13dc549fe1efcfd":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_cbcae1e838d347d5b539836ae19c307c","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_4366c97a01bf4915b304b10f3d41e428","IPY_MODEL_f5de5e06dead4a9ba856ec65ecf3bf33"]}},"cbcae1e838d347d5b539836ae19c307c":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"4366c97a01bf4915b304b10f3d41e428":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_35582cc558d1495e897d8686e8d8a9a9","_dom_classes":[],"description":"3/5(v): 100%","_model_name":"FloatProgressModel","bar_style":"success","max":118,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":118,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_0df05fdb2f894d5794973f487113b687"}},"f5de5e06dead4a9ba856ec65ecf3bf33":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_68a9450596144ba0a1b73ee8b7098a33","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 118/118 [00:09&lt;00:00, 11.92it/s, val_binary_acc=0.8741, val_loss=0.4773]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_7f0856b7a6d24acd93adb94fe06b8589"}},"35582cc558d1495e897d8686e8d8a9a9":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"0df05fdb2f894d5794973f487113b687":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"68a9450596144ba0a1b73ee8b7098a33":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"7f0856b7a6d24acd93adb94fe06b8589":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"cd06074114a84453bc3a7d5f3a9c3e9b":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_515acabe3525447fb5277b791df975f1","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_f08c6401d0d646e6ac031f7fb5260ff6","IPY_MODEL_1ecde908b1944727b8bcbe675e4062db"]}},"515acabe3525447fb5277b791df975f1":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"f08c6401d0d646e6ac031f7fb5260ff6":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_5891e72ddab34ab99c1fe368fc98bf04","_dom_classes":[],"description":"4/5(t): 100%","_model_name":"FloatProgressModel","bar_style":"success","max":274,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":274,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_78d6db5df4f3474295bf72d1a463b255"}},"1ecde908b1944727b8bcbe675e4062db":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_e70f129d3c94498dbc23406d3a1245b5","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 274/274 [00:42&lt;00:00,  6.46it/s, binary_acc=0.9925, loss=0.0229, running_binary_acc=0.9916, running_loss=0.0228]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_beef4602994c4af2a1ccd03cc59acd98"}},"5891e72ddab34ab99c1fe368fc98bf04":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"78d6db5df4f3474295bf72d1a463b255":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"e70f129d3c94498dbc23406d3a1245b5":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"beef4602994c4af2a1ccd03cc59acd98":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"9bfdba4d798447be9872b2abdc032833":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_a5b8fe74c3ca4b249e1f6cb216eea777","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_2099b8c2cdd442398ba74e4c385a8ff3","IPY_MODEL_45be6ac2892c4b3199113c05d4ab121d"]}},"a5b8fe74c3ca4b249e1f6cb216eea777":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"2099b8c2cdd442398ba74e4c385a8ff3":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_f3082845eec3488fb258c33b41f08665","_dom_classes":[],"description":"4/5(v): 100%","_model_name":"FloatProgressModel","bar_style":"success","max":118,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":118,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_3c426f95d90b4893b54eb5a4335fdff1"}},"45be6ac2892c4b3199113c05d4ab121d":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_5eae8ac18fe7428da97a733bf252cb63","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 118/118 [00:35&lt;00:00,  3.34it/s, val_binary_acc=0.8759, val_loss=0.5678]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_4b0ef49557dd44d9a9c31194d65e3361"}},"f3082845eec3488fb258c33b41f08665":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"3c426f95d90b4893b54eb5a4335fdff1":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"5eae8ac18fe7428da97a733bf252cb63":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"4b0ef49557dd44d9a9c31194d65e3361":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"1a2b8df3efc84f6c97594f902add9c39":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_08aad1da0e6c44cdb5a67a287e263fba","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_8aa5b39bf6984cbbba6fa4ebd7159fac","IPY_MODEL_47c1555ecee74161a4c662d6ae42af64"]}},"08aad1da0e6c44cdb5a67a287e263fba":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"8aa5b39bf6984cbbba6fa4ebd7159fac":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_cba928a17bd647fca80a582c23a646bf","_dom_classes":[],"description":"0/1(p): 100%","_model_name":"FloatProgressModel","bar_style":"success","max":391,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":391,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_edc0ba74860d49f2ada92604ce397b2f"}},"47c1555ecee74161a4c662d6ae42af64":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_3e4b5a89a5ff4096aecb65c055a9cf54","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 391/391 [00:33&lt;00:00, 11.80it/s, test_binary_acc=0.8704, test_loss=0.5867]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_60564f9892bd4459883fdf1edbe5a784"}},"cba928a17bd647fca80a582c23a646bf":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"edc0ba74860d49f2ada92604ce397b2f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"3e4b5a89a5ff4096aecb65c055a9cf54":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"60564f9892bd4459883fdf1edbe5a784":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}}}}},"cells":[{"cell_type":"markdown","metadata":{"id":"JVBmtieTChJp"},"source":["# Part 3: Sequence Classification"]},{"cell_type":"markdown","metadata":{"id":"ghxJsNIGChJ1"},"source":["__Before starting, we recommend you enable GPU acceleration if you're running on Colab.__"]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"ptoQhvOGChJ2","executionInfo":{"status":"ok","timestamp":1619167623408,"user_tz":-60,"elapsed":11069,"user":{"displayName":"Runwei GUAN","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gig5aqYr4QYZZfEUwoKWtgQYID2W1OyboKlv0UK=s64","userId":"03438131955681400592"}},"outputId":"e11e4f14-5d76-4485-a671-968f1e69ad70"},"source":["# Execute this code block to install dependencies when running on colab\n","try:\n","    import torch\n","except:\n","    from os.path import exists\n","    from wheel.pep425tags import get_abbr_impl, get_impl_ver, get_abi_tag\n","    platform = '{}{}-{}'.format(get_abbr_impl(), get_impl_ver(), get_abi_tag())\n","    cuda_output = !ldconfig -p|grep cudart.so|sed -e 's/.*\\.\\([0-9]*\\)\\.\\([0-9]*\\)$/cu\\1\\2/'\n","    accelerator = cuda_output[0] if exists('/dev/nvidia0') else 'cpu'\n","\n","    !pip install -q http://download.pytorch.org/whl/{accelerator}/torch-1.0.0-{platform}-linux_x86_64.whl torchvision\n","\n","try: \n","    import torchbearer\n","except:\n","    !pip install torchbearer\n","\n","try:\n","    import torchtext\n","except:\n","    !pip install torchtext\n","    \n","try:\n","    import spacy\n","except:\n","    !pip install spacy\n","    \n","try:\n","    spacy.load('en')\n","except:\n","    !python -m spacy download en"],"execution_count":1,"outputs":[{"output_type":"stream","text":["Collecting torchbearer\n","\u001b[?25l  Downloading https://files.pythonhosted.org/packages/ff/e9/4049a47dd2e5b6346a2c5d215b0c67dce814afbab1cd54ce024533c4834e/torchbearer-0.5.3-py3-none-any.whl (138kB)\n","\r\u001b[K     |██▍                             | 10kB 20.5MB/s eta 0:00:01\r\u001b[K     |████▊                           | 20kB 27.9MB/s eta 0:00:01\r\u001b[K     |███████▏                        | 30kB 21.1MB/s eta 0:00:01\r\u001b[K     |█████████▌                      | 40kB 16.7MB/s eta 0:00:01\r\u001b[K     |███████████▉                    | 51kB 15.2MB/s eta 0:00:01\r\u001b[K     |██████████████▎                 | 61kB 14.3MB/s eta 0:00:01\r\u001b[K     |████████████████▋               | 71kB 15.8MB/s eta 0:00:01\r\u001b[K     |███████████████████             | 81kB 15.3MB/s eta 0:00:01\r\u001b[K     |█████████████████████▍          | 92kB 14.7MB/s eta 0:00:01\r\u001b[K     |███████████████████████▊        | 102kB 15.9MB/s eta 0:00:01\r\u001b[K     |██████████████████████████      | 112kB 15.9MB/s eta 0:00:01\r\u001b[K     |████████████████████████████▌   | 122kB 15.9MB/s eta 0:00:01\r\u001b[K     |██████████████████████████████▉ | 133kB 15.9MB/s eta 0:00:01\r\u001b[K     |████████████████████████████████| 143kB 15.9MB/s \n","\u001b[?25hRequirement already satisfied: numpy in /usr/local/lib/python3.7/dist-packages (from torchbearer) (1.19.5)\n","Requirement already satisfied: torch>=1.0.0 in /usr/local/lib/python3.7/dist-packages (from torchbearer) (1.8.1+cu101)\n","Requirement already satisfied: tqdm in /usr/local/lib/python3.7/dist-packages (from torchbearer) (4.41.1)\n","Requirement already satisfied: typing-extensions in /usr/local/lib/python3.7/dist-packages (from torch>=1.0.0->torchbearer) (3.7.4.3)\n","Installing collected packages: torchbearer\n","Successfully installed torchbearer-0.5.3\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"ozQd4ebNChJ4"},"source":["## Sequence Classification\n","The problem that we will use to demonstrate sequence classification in this lab is the IMDB movie review sentiment classification problem. Each movie review is a variable sequence of words and the sentiment of each movie review must be classified.\n","\n","The Large Movie Review Dataset (often referred to as the IMDB dataset) contains 25,000 highly-polar movie reviews (good or bad) for training and the same amount again for testing. The problem is to determine whether a given movie review has a positive or negative sentiment. The data was collected by Stanford researchers and was used in a 2011 paper where a split of 50-50 of the data was used for training and test. An accuracy of 88.89% was achieved.\n","\n","We'll be using a **recurrent neural network** (RNN) as they are commonly used in analysing sequences. An RNN takes in sequence of words, $X=\\{x_1, ..., x_T\\}$, one at a time, and produces a _hidden state_, $h$, for each word. We use the RNN _recurrently_ by feeding in the current word $x_t$ as well as the hidden state from the previous word, $h_{t-1}$, to produce the next hidden state, $h_t$. \n","\n","$$h_t = \\text{RNN}(x_t, h_{t-1})$$\n","\n","Once we have our final hidden state, $h_T$, (from feeding in the last word in the sequence, $x_T$) we feed it through a linear layer, $f$, (also known as a fully connected layer), to receive our predicted sentiment, $\\hat{y} = f(h_T)$.\n","\n","Below shows an example sentence, with the RNN predicting zero, which indicates a negative sentiment. The RNN is shown in orange and the linear layer shown in silver. Note that we use the same RNN for every word, i.e. it has the same parameters. The initial hidden state, $h_0$, is a tensor initialized to all zeros. \n","\n","![](http://comp6248.ecs.soton.ac.uk/labs/lab7/assets/sentiment1.png)\n","\n","**Note:** some layers and steps have been omitted from the diagram, but these will be explained later.\n","\n","\n","The TorchText library provides easy access to the IMDB dataset. The `IMDB` class allows you to load the dataset in a format that is ready for use in neural network and deep learning models, and TorchText's utility methods allow us to easily create batches of data that are `padded` to the same length (we need to pad shorter sentences in the batch to the length of the longest sentence)."]},{"cell_type":"markdown","metadata":{"id":"JFZvThbrChJ5"},"source":["One of the main concepts of TorchText is the `Field`. These define how your data should be processed. In our sentiment classification task the data consists of both the raw string of the review and the sentiment, either \"pos\" or \"neg\".\n","\n","The parameters of a `Field` specify how the data should be processed. \n","\n","We use the `TEXT` field to define how the review should be processed, and the `LABEL` field to process the sentiment. \n","\n","Our `TEXT` field has `tokenize='spacy'` as an argument. This defines that the \"tokenization\" (the act of splitting the string into discrete \"tokens\") should be done using the [spaCy](https://spacy.io) tokenizer. If no `tokenize` argument is passed, the default is simply splitting the string on spaces.\n","\n","`LABEL` is defined by a `LabelField`, a special subset of the `Field` class specifically used for handling labels. We will explain the `dtype` argument later.\n","\n","For more on `Fields`, go [here](https://github.com/pytorch/text/blob/master/torchtext/data/field.py)."]},{"cell_type":"code","metadata":{"id":"5BXVayKZChJ5","executionInfo":{"status":"ok","timestamp":1619167624104,"user_tz":-60,"elapsed":11760,"user":{"displayName":"Runwei GUAN","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gig5aqYr4QYZZfEUwoKWtgQYID2W1OyboKlv0UK=s64","userId":"03438131955681400592"}}},"source":["from torchtext.legacy import data, datasets\n","\n","TEXT = data.Field(tokenize='spacy', lower=True, include_lengths=True)\n","LABEL = data.LabelField(dtype=torch.float)\n"],"execution_count":2,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"Zh-ncH5rChJ6"},"source":["The following code automatically downloads the IMDb dataset and splits it into the canonical train/test splits as `torchtext.datasets` objects. It process the data using the `Fields` we have previously defined. Note that the following can take a couple of minutes to run due to the tokenisation:"]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"E8KtIuCZChJ7","executionInfo":{"status":"ok","timestamp":1619168491354,"user_tz":-60,"elapsed":878977,"user":{"displayName":"Runwei GUAN","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gig5aqYr4QYZZfEUwoKWtgQYID2W1OyboKlv0UK=s64","userId":"03438131955681400592"}},"outputId":"797d8c6f-df21-4d9e-f334-3a146cbf60be"},"source":["train_data, test_data = datasets.IMDB.splits(TEXT, LABEL)"],"execution_count":3,"outputs":[{"output_type":"stream","text":["downloading aclImdb_v1.tar.gz\n"],"name":"stdout"},{"output_type":"stream","text":["aclImdb_v1.tar.gz: 100%|██████████| 84.1M/84.1M [00:08<00:00, 10.5MB/s]\n"],"name":"stderr"}]},{"cell_type":"markdown","metadata":{"id":"IzlbAXqsChJ8"},"source":["We can see how many examples are in each split by checking their length."]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"kkAAJNmJChJ8","executionInfo":{"status":"ok","timestamp":1619168491355,"user_tz":-60,"elapsed":877878,"user":{"displayName":"Runwei GUAN","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gig5aqYr4QYZZfEUwoKWtgQYID2W1OyboKlv0UK=s64","userId":"03438131955681400592"}},"outputId":"d98c6d06-ccba-4164-c826-d9c55c988cba"},"source":["print(f'Number of training examples: {len(train_data)}')\n","print(f'Number of testing examples: {len(test_data)}')"],"execution_count":4,"outputs":[{"output_type":"stream","text":["Number of training examples: 25000\n","Number of testing examples: 25000\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"taS1GbyiChJ8"},"source":["We can also check an example."]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"a3mH--HfChJ9","executionInfo":{"status":"ok","timestamp":1619168491355,"user_tz":-60,"elapsed":875848,"user":{"displayName":"Runwei GUAN","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gig5aqYr4QYZZfEUwoKWtgQYID2W1OyboKlv0UK=s64","userId":"03438131955681400592"}},"outputId":"bd3039d9-7232-459b-f546-cbfd437d7b12"},"source":["print(vars(train_data.examples[0]))  # text(single words sequence) and label\n"],"execution_count":5,"outputs":[{"output_type":"stream","text":["{'text': ['when', 'this', 'film', 'was', 'originally', 'released', 'it', 'was', 'promoted', 'with', 'the', 'notably', 'unimaginative', 'tagline', '\"', 'dirty', 'harry', 'is', 'at', 'it', 'again', '\"', '.', 'whatever', 'this', 'pitch', 'lacks', 'in', 'originality', 'is', 'more', 'than', 'compensated', 'for', 'by', 'it', \"'s\", 'complete', 'and', 'total', 'accuracy', '.', '\"', 'sudden', 'impact', '\"', 'retains', 'all', 'the', 'aspects', 'that', 'made', 'the', 'previous', 'three', 'dirty', 'harry', 'movies', 'so', 'successful-', 'tight', 'pacing', ',', 'a', 'compelling', 'plot', ',', 'strong', 'supporting', 'characters', ',', 'endless', 'gunplay', ',', 'and', 'bone', '-', 'dry', 'humor', '.', 'some', 'of', 'these', 'elements', 'are', 'not', 'only', 'retained', 'but', 'amplified-', 'this', 'is', 'easily', 'the', 'darkest', ',', 'bloodiest', ',', 'and', 'most', 'overtly', 'right', '-', 'wing', 'installment', 'of', 'the', 'franchise.<br', '/><br', '/>the', 'plot', 'is', 'somewhat', 'intriguing', ':', 'after', 'killing', 'a', 'ridiculous', 'number', 'of', 'hoodlums', ',', 'inspector', 'callahan', 'is', 'sent', 'on', 'a', 'forced', '\"', 'vacation', '\"', 'by', 'his', 'superiors', 'to', 'the', 'sleepy', 'coastal', 'town', 'of', 'san', 'paolo', '.', 'he', 'is', 'tasked', 'to', 'investigate', 'the', 'background', 'of', 'a', 'recent', 'homicide', 'victim', 'who', 'was', 'shot', 'in', 'the', 'genitals', 'before', 'being', 'put', 'out', 'of', 'his', '(', 'no', 'doubt', 'considerable', ')', 'misery', 'by', 'a', 'second', 'shot', 'to', 'the', 'head', '.', 'early', 'on', 'in', 'the', 'film', ',', 'the', 'audience', 'is', 'made', 'aware', 'of', 'the', 'identity', 'of', 'the', 'killer-', 'an', 'artist', 'named', 'jennifer', 'spencer', '(', 'sondra', 'locke', ')', 'who', 'is', 'hunting', 'down', 'the', 'thugs', 'who', 'gang', '-', 'raped', 'her', 'and', 'her', 'sister', 'at', 'a', 'fun', 'fair', 'some', 'ten', 'years', 'earlier', '.', 'this', 'incident', 'is', 'shown', 'in', 'a', 'very', 'disturbing', 'flashback', ',', 'snippets', 'of', 'which', 'recur', 'before', 'each', 'new', 'murder', '.', 'as', 'more', 'bodies', 'start', 'to', 'appear', 'with', 'the', 'same', 'm.o', ',', 'it', 'becomes', 'clear', 'to', 'harry', 'that', 'both', 'the', 'local', 'police', 'chief', 'and', 'his', 'new', 'love', 'interest', '(', 'guess', 'who', '?', ')', 'know', 'more', 'than', 'they', 'are', 'telling', '.', 'to', 'make', 'matters', 'even', 'more', 'complicated', ',', 'the', 'one', '-', 'time', 'rapists', 'realize', 'who', 'is', 'hunting', 'them', 'and', 'start', 'to', 'hit', 'back', 'hard.<br', '/><br', '/>\"sudden', 'impact', '\"', 'offers', 'relentless', 'action', 'from', 'beginning', 'to', 'end', '.', 'clint', 'eastwood', 'directed', 'this', 'film', 'himself', 'and', 'expertly', 'handles', 'a', 'series', 'of', 'set', 'pieces', 'that', 'culminate', 'in', 'an', 'exhilarating', 'climax', '.', 'sondra', 'locke', \"'s\", 'performance', 'effectively', 'conveys', 'the', 'blend', 'of', 'ruthlessness', 'and', 'fragility', 'that', 'define', 'her', 'character', '.', 'that', 'having', 'been', 'said', ',', 'it', 'is', 'fair', 'to', 'wonder', 'if', 'another', 'actress', '(', 'who', 'was', 'not', 'eastwood', \"'s\", 'off', '-', 'screen', 'companion', 'at', 'the', 'time', ')', 'could', 'have', 'brought', 'more', 'charisma', 'and', 'dramatic', 'weight', 'to', 'the', 'role-', 'theresa', 'russell', 'and', 'cybill', 'shepherd', 'jump', 'to', 'mind', 'as', 'possible', 'candidates', '.', 'members', 'of', 'the', 'supporting', 'cast', 'that', 'punch', 'significantly', 'above', 'their', 'weight', 'include', 'albert', 'popwell', 'as', 'harry', \"'s\", 'partner', 'horace', ',', 'paul', 'drake', 'as', 'the', 'psychopathic', 'mick', ',', 'and', 'the', 'truly', 'scene', '-', 'stealing', 'audrie', 'j.', 'neenan', 'who', 'portrays', 'the', 'vicious', 'ray', 'parkins', '.', '<', 'br', '/><br', '/>however', 'the', 'film', 'has', 'some', 'notable', 'problems-', 'some', 'of', 'the', 'subplots', '(', 'the', 'animosity', 'between', 'harry', 'and', 'a', 'gang', 'of', 'twentysomething', 'hoodlums', ',', 'a', 'mob', 'vendetta', 'against', 'him', ')', 'take', 'up', 'too', 'much', 'screen', 'time', 'and', 'do', \"n't\", 'really', 'have', 'any', 'bearing', 'to', 'the', 'larger', 'story', '.', 'their', 'only', 'real', 'use', 'is', 'to', 'raise', 'the', 'body', '-', 'count', 'to', 'absurd', 'levels', '.', 'in', 'the', 'first', 'half', 'of', 'the', 'film', 'it', 'sometimes', 'appears', 'that', 'dirty', 'harry', 'shoots', 'people', 'more', 'often', 'than', 'he', 'has', 'to', 'use', 'the', 'restroom', '.', 'however', 'the', 'film', 'moves', 'into', 'top', 'gear', 'as', 'it', 'progresses', 'and', 'the', 'triangulated', 'cat', '-', 'and', '-', 'mouse', 'game', 'between', 'callahan', ',', 'spencer', ',', 'and', 'her', 'former', 'tormentors', 'assumes', 'prominence', '.', 'this', 'second', 'hour', 'makes', 'it', 'clear', 'that', 'a', 'more', 'stripped', '-', 'down', 'and', 'slightly', 'refocused', 'screenplay', 'would', 'have', 'given', '\"', 'sudden', 'impact', '\"', 'the', 'potential', 'to', 'be', 'a', 'first', '-', 'class', ',', 'neo', 'noir', '-', 'style', 'thriller', 'that', 'could', 'have', 'taken', 'the', 'series', 'to', 'new', 'levels', 'but', 'still', 'have', 'contained', 'more', 'than', 'enough', '.44', 'magnum', 'heroics', 'to', 'satisfy', 'the', 'harry', 'loyalists', '.', 'instead', 'we', 'get', 'the', 'film', 'that', 'eastwood', 'and', 'warner', 'bros.', 'clearly', 'wanted', 'to', 'make-', 'a', 'superbly', 'executed', 'but', 'prototypical', 'eighties', 'action', 'flick', 'that', 'mostly', 'declines', 'to', 'particularly', 'challenge', 'the', 'intelligence', 'of', 'it', \"'s\", 'intended', 'audience', '.', '<', 'br', '/><br', '/>this', 'was', 'by', 'far', 'the', 'biggest', 'grossing', 'of', 'the', 'series', 'at', 'the', 'box', '-', 'office', 'and', 'it', 'is', 'not', 'hard', 'to', 'see', 'why', '.', 'though', 'not', 'the', 'film', 'that', 'it', 'could', 'have', 'been', ',', 'this', 'is', 'still', 'big', ',', 'trigger', '-', 'happy', 'fun', '.', 'even', 'after', 'repeated', 'viewings', ',', 'it', \"'s\", 'going', 'to', 'make', 'your', 'day', '.'], 'label': 'pos'}\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"rrcliOWyChJ9"},"source":["The IMDb dataset only has train/test splits, so we need to create a validation set. We can do this with the `.split()` method. \n","\n","By default this splits 70/30, however by passing a `split_ratio` argument, we can change the ratio of the split, i.e. a `split_ratio` of 0.8 would mean 80% of the examples make up the training set and 20% make up the validation set. \n","\n","We also pass our random seed to the `random_state` argument, ensuring that we get the same train/validation split each time."]},{"cell_type":"code","metadata":{"id":"SSRGpy19ChJ9","executionInfo":{"status":"ok","timestamp":1619168491356,"user_tz":-60,"elapsed":875063,"user":{"displayName":"Runwei GUAN","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gig5aqYr4QYZZfEUwoKWtgQYID2W1OyboKlv0UK=s64","userId":"03438131955681400592"}}},"source":["import random\n","\n","train_data, valid_data = train_data.split()"],"execution_count":6,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"wLqbMG0CChJ9"},"source":["Again, we'll view how many examples are in each split."]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"4K8qaf-RChJ9","executionInfo":{"status":"ok","timestamp":1619168491357,"user_tz":-60,"elapsed":873512,"user":{"displayName":"Runwei GUAN","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gig5aqYr4QYZZfEUwoKWtgQYID2W1OyboKlv0UK=s64","userId":"03438131955681400592"}},"outputId":"057a12b6-ad8f-4363-df68-4692bc288919"},"source":["print(f'Number of training examples: {len(train_data)}')\n","print(f'Number of validation examples: {len(valid_data)}')\n","print(f'Number of testing examples: {len(test_data)}')"],"execution_count":7,"outputs":[{"output_type":"stream","text":["Number of training examples: 17500\n","Number of validation examples: 7500\n","Number of testing examples: 25000\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"mUVzjmpGChJ9"},"source":["Next, we have to build a _vocabulary_. This is effectively a look up table where every unique word in your data set has a corresponding _index_ (an integer).\n","\n","We do this as our machine learning model cannot operate on strings, only numbers. Each _index_ is used to construct a _one-hot_ vector for each word. A one-hot vector is a vector where all of the elements are 0, except one, which is 1, and dimensionality is the total number of unique words in your vocabulary, commonly denoted by $V$.\n","\n","![](http://comp6248.ecs.soton.ac.uk/labs/lab7/assets/sentiment5.png)\n","\n","The number of unique words in our training set is over 100,000, which means that our one-hot vectors will have over 100,000 dimensions! This will make training slow and possibly won't fit onto your GPU (if you're using one). \n","\n","There are two ways to effectively cut-down our vocabulary, we can either only take the top $n$ most common words or ignore words that appear less than $m$ times. We'll do the former, only keeping the top 25,000 words.\n","\n","What do we do with words that appear in examples but we have cut from the vocabulary? We replace them with a special _unknown_ or `<unk>` token. For example, if the sentence was \"This film is great and I love it\" but the word \"love\" was not in the vocabulary, it would become \"This film is great and I `<unk>` it\".\n","\n","The following builds the vocabulary, only keeping the most common `max_size` tokens."]},{"cell_type":"code","metadata":{"id":"bfrbhYZPChJ-","executionInfo":{"status":"ok","timestamp":1619168492745,"user_tz":-60,"elapsed":872880,"user":{"displayName":"Runwei GUAN","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gig5aqYr4QYZZfEUwoKWtgQYID2W1OyboKlv0UK=s64","userId":"03438131955681400592"}}},"source":["TEXT.build_vocab(train_data, max_size=25000)\n","LABEL.build_vocab(train_data)"],"execution_count":8,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"hBVh_pNtChJ-"},"source":["Why do we only build the vocabulary on the training set? When testing any machine learning system you do not want to look at the test set in any way. We do not include the validation set as we want it to reflect the test set as much as possible."]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"2L6mXB98ChJ-","executionInfo":{"status":"ok","timestamp":1619168492748,"user_tz":-60,"elapsed":872136,"user":{"displayName":"Runwei GUAN","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gig5aqYr4QYZZfEUwoKWtgQYID2W1OyboKlv0UK=s64","userId":"03438131955681400592"}},"outputId":"8a25bd45-7ccc-40aa-dea4-11a898179ead"},"source":["print(f\"Unique tokens in TEXT vocabulary: {len(TEXT.vocab)}\")\n","print(f\"Unique tokens in LABEL vocabulary: {len(LABEL.vocab)}\")"],"execution_count":9,"outputs":[{"output_type":"stream","text":["Unique tokens in TEXT vocabulary: 25002\n","Unique tokens in LABEL vocabulary: 2\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"QT7jcmSCChJ_"},"source":["Why is the vocab size 25002 and not 25000? One of the addition tokens is the `<unk>` token and the other is a `<pad>` token.\n","\n","When we feed sentences into our model, we feed a _batch_ of them at a time, i.e. more than one at a time, and all sentences in the batch need to be the same size. Thus, to ensure each sentence in the batch is the same size, any sentences which are shorter than the longest within the batch are padded.\n","\n","![](http://comp6248.ecs.soton.ac.uk/labs/lab7/assets/sentiment6.png)\n","\n","We can also view the most common words in the vocabulary and their frequencies."]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"vc8n9BuLChJ_","executionInfo":{"status":"ok","timestamp":1619168492749,"user_tz":-60,"elapsed":870231,"user":{"displayName":"Runwei GUAN","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gig5aqYr4QYZZfEUwoKWtgQYID2W1OyboKlv0UK=s64","userId":"03438131955681400592"}},"outputId":"e12f96bf-affa-41cb-8b5e-3dc207c800ab"},"source":["print(TEXT.vocab.freqs.most_common(20))"],"execution_count":10,"outputs":[{"output_type":"stream","text":["[('the', 230438), (',', 193163), ('.', 165971), ('and', 114189), ('a', 113091), ('of', 102144), ('to', 94994), ('is', 76910), ('it', 65904), ('in', 65145), ('i', 58376), ('this', 51580), ('that', 51424), ('\"', 44614), (\"'s\", 43847), ('-', 37170), ('was', 35665), ('/><br', 35461), ('as', 32553), ('for', 30847)]\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"Hx6R0v1AChJ_"},"source":["We can also see the vocabulary directly using either the `stoi` (**s**tring **to** **i**nt) or `itos` (**i**nt **to**  **s**tring) method."]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"K4CqR6jNChJ_","executionInfo":{"status":"ok","timestamp":1619168492749,"user_tz":-60,"elapsed":869400,"user":{"displayName":"Runwei GUAN","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gig5aqYr4QYZZfEUwoKWtgQYID2W1OyboKlv0UK=s64","userId":"03438131955681400592"}},"outputId":"21aad9cd-d416-4010-859f-64c5fc752e55"},"source":["print(TEXT.vocab.itos[:10])"],"execution_count":11,"outputs":[{"output_type":"stream","text":["['<unk>', '<pad>', 'the', ',', '.', 'and', 'a', 'of', 'to', 'is']\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"KUqMz2anChJ_"},"source":["We can also check the labels, ensuring 0 is for negative and 1 is for positive."]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"lr-RW2sOChKA","executionInfo":{"status":"ok","timestamp":1619168492750,"user_tz":-60,"elapsed":868093,"user":{"displayName":"Runwei GUAN","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gig5aqYr4QYZZfEUwoKWtgQYID2W1OyboKlv0UK=s64","userId":"03438131955681400592"}},"outputId":"92132880-0b17-4737-db63-4b587657a91e"},"source":["print(LABEL.vocab.stoi)"],"execution_count":12,"outputs":[{"output_type":"stream","text":["defaultdict(None, {'neg': 0, 'pos': 1})\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"iRkiANFjChKA"},"source":["The final step of preparing the data is creating the iterators. We iterate over these in the training/evaluation loop, and they return a batch of examples (indexed and converted into tensors) at each iteration.\n","\n","We'll use a `BucketIterator` which is a special type of iterator that will return a batch of examples where each example is of a similar length, minimizing the amount of padding per example. Torchtext will pad for us automatically (handled by the `Field` object). We'll request the items within each batch produced by the `BucketIterator` are sorted by length.\n","\n","We also want to place the tensors returned by the iterator on the GPU (if you're using one). PyTorch handles this using `torch.device`, we then pass this device to the iterator."]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"hTGLpwSEChKB","executionInfo":{"status":"ok","timestamp":1619168492750,"user_tz":-60,"elapsed":866641,"user":{"displayName":"Runwei GUAN","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gig5aqYr4QYZZfEUwoKWtgQYID2W1OyboKlv0UK=s64","userId":"03438131955681400592"}},"outputId":"fd0daac5-4fcb-47e4-f768-70c70b87a443"},"source":["BATCH_SIZE = 64\n","\n","device = torch.device('cuda' if torch.cuda.is_available() else 'cpu')\n","\n","train_iterator, valid_iterator, test_iterator = data.BucketIterator.splits(\n","    (train_data, valid_data, test_data), \n","    batch_size=BATCH_SIZE,\n","    device=device,\n","    sort_key=lambda x: len(x.text),\n","    sort_within_batch=True)\n","\n","print(\"train_iterator total data:\", len(train_iterator.dataset))\n","print(\"train_iterator batch size:\", train_iterator.batch_size)"],"execution_count":13,"outputs":[{"output_type":"stream","text":["train_iterator total data: 17500\n","train_iterator batch size: 64\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"SFzDuuWFChKB"},"source":["## Build the Model\n","\n","The next stage is building the model that we'll eventually train and evaluate. \n","\n","There is a small amount of boilerplate code when creating models in PyTorch, note how our `RNN` class is a sub-class of `nn.Module` and the use of `super`.\n","\n","Within the `__init__` we define the _layers_ of the module. Our three layers are an _embedding_ layer, our RNN, and a _linear_ layer. All layers have their parameters initialized to random values, unless explicitly specified.\n","\n","The embedding layer is used to transform our sparse one-hot vector (sparse as most of the elements are 0) into a dense embedding vector (dense as the dimensionality is a lot smaller and all the elements are real numbers). This embedding layer is simply a single fully connected layer. As well as reducing the dimensionality of the input to the RNN, there is the theory that words which have similar impact on the sentiment of the review are mapped close together in this dense vector space. For more information about word embeddings, see [here](https://monkeylearn.com/blog/word-embeddings-transform-text-numbers/).\n","\n","The RNN layer is our RNN which takes in our dense vector and the previous hidden state $h_{t-1}$, which it uses to calculate the next hidden state, $h_t$.\n","\n","![](http://comp6248.ecs.soton.ac.uk/labs/lab7/assets/sentiment7.png)\n","\n","Finally, the linear layer takes the final hidden state and feeds it through a fully connected layer, $f(h_T)$, transforming it to the correct output dimension.\n","\n","The `forward` method is called when we feed examples into our model.\n","\n","Each batch, `text_len`, is a tuple containing a tensor of size _**[max_sentence length, batch size]**_ and a tensor of **batch_size** containing the true lengths of each sentence (remember, they won't necessarily be the same; some reviews are much longer than others). \n","\n","The first tensor in the tuple contains the ordered word indexes for each review in the batch. The act of converting a list of tokens into a list of indexes is commonly called *numericalizing*.\n","\n","The input batch is then passed through the embedding layer to get `embedded`, which gives us a dense vector representation of our sentences. `embedded` is a tensor of size _**[sentence length, batch size, embedding dim]**_. \n","\n","`embedded` is then fed into a function called `pack_padded_sequence` before being fed into the RNN. `pack_padded_sequence` is used to create a datastructure that allows the RNN to 'mask' off the padding during the BPTT process (we don't want to learn the padding, as this could drastically influence the results!). In some frameworks you must feed the initial hidden state, $h_0$, into the RNN, however in PyTorch, if no initial hidden state is passed as an argument it defaults to a tensor of all zeros.\n","\n","The RNN returns 2 tensors, `output` of size _**[sentence length, batch size, hidden dim]**_ and `hidden` of size _**[1, batch size, hidden dim]**_. `output` is the concatenation of the hidden state from every time step, whereas `hidden` is simply the final hidden state. \n","\n","Finally, we feed the last hidden state, `hidden`, through the linear layer, `fc`, to produce a prediction. Note the `squeeze` method, which is used to remove a dimension of size 1. "]},{"cell_type":"code","metadata":{"id":"L7e4_FouChKC","executionInfo":{"status":"ok","timestamp":1619168990837,"user_tz":-60,"elapsed":646,"user":{"displayName":"Runwei GUAN","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gig5aqYr4QYZZfEUwoKWtgQYID2W1OyboKlv0UK=s64","userId":"03438131955681400592"}}},"source":["import torch.nn as nn\n","\n","class RNN(nn.Module):\n","    def __init__(self, input_dim, embedding_dim, hidden_dim, output_dim):\n","        super().__init__()\n","        \n","        self.embedding = nn.Embedding(input_dim, embedding_dim)\n","        self.rnn = nn.RNN(embedding_dim, hidden_dim)\n","        self.fc = nn.Linear(hidden_dim, output_dim)\n","        \n","    def forward(self, text, lengths):\n","        embedded = self.embedding(text)\n","        embedded = nn.utils.rnn.pack_padded_sequence(embedded, lengths.cpu())\n","        packed_output, hidden = self.rnn(embedded)\n","\n","        return self.fc(hidden.squeeze(0))"],"execution_count":24,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"GLEvTKCmChKC"},"source":["We now create an instance of our RNN class. \n","\n","The input dimension is the dimension of the one-hot vectors, which is equal to the vocabulary size. \n","\n","The embedding dimension is the size of the dense word vectors. This is usually around 50-250 dimensions, but depends on the size of the vocabulary.\n","\n","The hidden dimension is the size of the hidden states. This is usually around 100-500 dimensions, but also depends on factors such as on the vocabulary size, the size of the dense vectors and the complexity of the task.\n","\n","The output dimension is usually the number of classes, however in the case of only 2 classes the output value is between 0 and 1 and thus can be 1-dimensional, i.e. a single scalar real number."]},{"cell_type":"code","metadata":{"id":"uNkYwFUgChKC","executionInfo":{"status":"ok","timestamp":1619168992972,"user_tz":-60,"elapsed":715,"user":{"displayName":"Runwei GUAN","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gig5aqYr4QYZZfEUwoKWtgQYID2W1OyboKlv0UK=s64","userId":"03438131955681400592"}}},"source":["INPUT_DIM = len(TEXT.vocab)\n","EMBEDDING_DIM = 50\n","HIDDEN_DIM = 100\n","OUTPUT_DIM = 1\n","\n","model = RNN(INPUT_DIM, EMBEDDING_DIM, HIDDEN_DIM, OUTPUT_DIM)"],"execution_count":25,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"0ynqy0shChKD"},"source":["# Train the model\n","\n","Now we'll set up the training and then train the model.\n","\n","First, we'll create an optimizer. This is the algorithm we use to update the parameters of the module. Here, we'll use _stochastic gradient descent_ (SGD). The first argument is the parameters that will be updated by the optimizer, the second is the learning rate, i.e. how much we'll change the parameters by when we do a parameter update."]},{"cell_type":"code","metadata":{"id":"ktC1fSL9ChKD","executionInfo":{"status":"ok","timestamp":1619168892972,"user_tz":-60,"elapsed":542,"user":{"displayName":"Runwei GUAN","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gig5aqYr4QYZZfEUwoKWtgQYID2W1OyboKlv0UK=s64","userId":"03438131955681400592"}}},"source":["import torch.optim as optim\n","\n","optimizer = optim.SGD(model.parameters(), lr=0.001)"],"execution_count":21,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"83Uppfb-ChKD"},"source":["Next, we'll define our loss function. In PyTorch this is commonly called a criterion. \n","\n","The loss function here is _binary cross entropy with logits_. \n","\n","Our model currently outputs an unbound real number. As our labels are either 0 or 1, we want to restrict the predictions to a number between 0 and 1. We do this using the _sigmoid_ function. \n","\n","We then use this this bound scalar to calculate the loss using binary cross entropy. \n","\n","The `BCEWithLogitsLoss` criterion carries out both the sigmoid and the binary cross entropy steps."]},{"cell_type":"code","metadata":{"id":"xZDBD-x6ChKD","executionInfo":{"status":"ok","timestamp":1619168996123,"user_tz":-60,"elapsed":704,"user":{"displayName":"Runwei GUAN","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gig5aqYr4QYZZfEUwoKWtgQYID2W1OyboKlv0UK=s64","userId":"03438131955681400592"}}},"source":["criterion = nn.BCEWithLogitsLoss()"],"execution_count":26,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"_pi93r7MChKE"},"source":["Finally, before creating a Torchbearer trial and copying the model to the GPU (if we have one), we need to adapt the format of the batches returned by TorchText. TorchText's iterators return an object representing a batch of data from which you can access the fields used to store the underlying data (e.g. the labels and words in our case). Torchbearer on the other hand needs to know what the X's and y's are explicitly. \n","\n","There are a number of ways in which we can adapt the batch data format, but one of the easiest conceptually is to write a simple wrapper iterator that reads the next torchtext batch and returns a tuple of objects (the X and y). Note that because we specified that we want the lengths of the sentences earlier, the X's will be a tuple of the sentences and their lengths. If we had not requested the lengths, then the X's would just be a tensor encoding the padded sentences."]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":693,"referenced_widgets":["93b86582d76447af830fb1dfbd770de6","72b181dccd00427b89b59e103772bbc6","0d02dc369bd443a2973eaa6581db72f5","198bad2aad8844d5b498a510fcdfd3cf","692c78a212ba4e3792fa764a1aba34af","1d268bede55f41428b9f542b2ed9b966","562c400fa2b747709ec3a4262519ecd7","9ef6c145a998473f83e3cdcb5f5e9c8c","0bb72d40c03348bd8cc276a95900c733","d36523f856814ed4828c48f24f99ee16","cce85deac7e44f8eb67dae51f49211d4","98c63e32fd114abd82fe71a9fae3b851","09fda00619f3406d9a576a1da5e25237","514cd2c552d74ac1b3f8ecec0a7c7785","379dab05524f48b2bdf5cc44ad93a64e","2c90a20daa9148bb837a39f75754c09f","d878db33e9af4ef58578779f883336da","8594eabd7f834ec697135c0bda936077","073297ff6b514e2d8f027a7511c7fcdc","98f651b13c8c497094dbaf4f2abe3613","b87f49c91216474782f985af118695e2","0eea6b9bb61b4e2ea03128179be74238","65ac1f22bf654f6fa26f2456c3c40bb9","a7e3e40ac6f4420ea1db3764e28021b4","275c78605231495fb60418b7dcd4636e","1d2d880d25774da79d136b09132b262c","51f7c7e483e74c74bdcd212dae0207fe","6b639291dbcc4dd3905c4df716146172","10358a03430047df9ef0e84da38e4c12","768d74ef0a7b490494cfd05ee68244a3","d76656297d4249f5a1d32435766a32a7","4b788ed0ce234a8f99128cbd39f3dc44","b320ee4d75a245e3be06ddf25d6a7973","38da2b4b1f9842809ce27863e7ae0c57","07f4777362714f4fa56bb86b19dcced5","5538c06b06654e608222a77611a352ba","2ded6d1add9e4efa8ea68d628cbf89da","35a4bd4917204ce7b32d4e7e49f2a7e6","137fb0b8944343bea81ec02a0a449d58","a13285e3b3cf4a1ba9625e14e76c7eee","e313d3aa1f584bcf94f22912c19e3657","39bbf21ad4ce4797acab1cfe1ce61cb3","8e52b64ea71c498d8981b3611f76ddb0","975eec76bb374ca998e46d218cd17302","0a7a0b2369044a679295cf978fed1ca2","6663db58ff1b4c46b43f3ea10769f54d","62f72b2e197a482b92d8027bf2cd9da6","7b1b03e835394f4896532ffca6fae0e6","cdce4888bfb4412a8e092b3e59460556","9f1f7567db5b4b21bfd3fba7f2882e60","9557f6f1d9904f93aaa9bf52fae42869","22a6396a477d4bb1bf0339d6a25336b6","b3c080ee51d7483b8b6e16f462b92d1e","e9c8235706574cd4acfcb604f2e3b755","a35026d68ef24ff19be4464a96b5be35","9da44a72f33a4bc1b034ab81a9a5dfbb","2ce1ef835fd247df9da72cce437488e0","7f6b0448ed2a4291b32bed7a59d66f8c","7bdbe5ec6dc9496ca5aa7c91d1cd6821","d97b41dd06724a86b1d144089c09fadd","bd9214fab4814628bf6d4f5d58d875a7","25770c6adc6f456291c3d75812abb6d0","bf2ca19442f74e0e8eaf9c3b250d01fb","e349e34141bc40dfbae6218056214a7a","b42f6747b3d24eaf91817692c7f67629","af53699b9c2f462ba6d12e5a91155b14","ab7348af26d647ebb5cfb1f74bd26142","2b1f161cb84840d1b2d8d17c965f86cd","a4260cf266c349d9962c97e5de71c0cf","fca50de6f7a14e079ef29091eaa37c3e","a1f10e45ce2b40689dbe628db402915e","9afd55b1d20742458e550cbb52e38223","bbcf49db00c84c5383ec1bd8aec8b535","c90b104d82294447a5fbcd7714d408d2","a9919dcbe3f04cb39d5d9aacb16ce5b0","1c61c5cf65b34a1194bb40eaf19e8a15","0efb4e8a330642c2a38fda71df5e8ed4","87ac4ebf520146bfa8a787021c3fdc5e","453f2f039e6e45c594253941eb34043e","6c8ccab359a64c2d955d06812bea3edb","cad20b7d680b4660b7a506db5409982e","435f4845676b46a3b48fec3c776da289","66289bd8eab548958fab1124ce1100a6","eb42354fd9224d6b88817b0350faaa3d","008a03cbe74f495194b78447c4b4c52a","52b9ecbf6ea244a485db9e7ed9d6a01a","41b06b7964d845f89bc31cb3a05ca8e5","773f54cf71e24517a5fc8c8e9c76296b"]},"id":"p5ixr_o-ChKF","executionInfo":{"status":"ok","timestamp":1619169045938,"user_tz":-60,"elapsed":48979,"user":{"displayName":"Runwei GUAN","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gig5aqYr4QYZZfEUwoKWtgQYID2W1OyboKlv0UK=s64","userId":"03438131955681400592"}},"outputId":"fd80e79e-f0dd-4de5-89fc-1c15abdc74f8"},"source":["from torchbearer import Trial\n","        \n","class MyIter:\n","    def __init__(self, it):\n","        self.it = it\n","    def __iter__(self):\n","        for batch in self.it:\n","            yield (batch.text, batch.label.unsqueeze(1))\n","    def __len__(self):\n","        return len(self.it)\n","\n","torchbearer_trial = Trial(model, optimizer, criterion, metrics=['acc', 'loss']).to(device)\n","torchbearer_trial.with_generators(train_generator=MyIter(train_iterator), val_generator=MyIter(valid_iterator), test_generator=MyIter(test_iterator))\n","torchbearer_trial.run(epochs=5)\n","torchbearer_trial.predict()"],"execution_count":27,"outputs":[{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"93b86582d76447af830fb1dfbd770de6","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, description='0/5(t)', max=274.0, style=ProgressStyle(description_width…"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"0bb72d40c03348bd8cc276a95900c733","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, description='0/5(v)', max=118.0, style=ProgressStyle(description_width…"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"d878db33e9af4ef58578779f883336da","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, description='1/5(t)', max=274.0, style=ProgressStyle(description_width…"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"275c78605231495fb60418b7dcd4636e","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, description='1/5(v)', max=118.0, style=ProgressStyle(description_width…"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"b320ee4d75a245e3be06ddf25d6a7973","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, description='2/5(t)', max=274.0, style=ProgressStyle(description_width…"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"e313d3aa1f584bcf94f22912c19e3657","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, description='2/5(v)', max=118.0, style=ProgressStyle(description_width…"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"cdce4888bfb4412a8e092b3e59460556","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, description='3/5(t)', max=274.0, style=ProgressStyle(description_width…"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"2ce1ef835fd247df9da72cce437488e0","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, description='3/5(v)', max=118.0, style=ProgressStyle(description_width…"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"b42f6747b3d24eaf91817692c7f67629","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, description='4/5(t)', max=274.0, style=ProgressStyle(description_width…"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"bbcf49db00c84c5383ec1bd8aec8b535","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, description='4/5(v)', max=118.0, style=ProgressStyle(description_width…"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"cad20b7d680b4660b7a506db5409982e","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, description='0/1(p)', max=391.0, style=ProgressStyle(description_width…"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n"],"name":"stdout"},{"output_type":"execute_result","data":{"text/plain":["tensor([[-0.1316],\n","        [ 0.2353],\n","        [ 0.1396],\n","        ...,\n","        [-0.0071],\n","        [ 0.2581],\n","        [-0.0447]], device='cuda:0')"]},"metadata":{"tags":[]},"execution_count":27}]},{"cell_type":"markdown","metadata":{"id":"CiYmgV_4ChKF"},"source":["__Use the box below to comment on and give insight into the performance of the above model:__"]},{"cell_type":"markdown","metadata":{"id":"6i5PjjTnChKF"},"source":["YOUR ANSWER HERE"]},{"cell_type":"markdown","metadata":{"id":"BG7pWWStChKF"},"source":["Now try and build a better model. Rather than using a plain RNN, we'll instead use a (single layer) LSTM, and we'll use Adam with an initial learning rate of 0.01 as the optimiser. __Complete the following code to implement the improved model, and then train it:__"]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":693,"referenced_widgets":["bed5b132bddb4b568d19e52fa00f1d21","fca982c910e84b75b596631e9d398fe8","5ad9e9e9db124ed6bf75e829b882e096","4babc0002ce145f5a30418983b841243","23630359eb8140e7a49450b92be88579","7d47bec079d44a4090d27bbd6371e2a9","9d7c0091026d455e8af6560e0f002502","a09632c77d0f44bda2491cf4ba7da3f1","1abf13dc6fe1499f9b344f0294c7c5d4","92f24d64cb4f4861bd96ff263b7dfa41","b58f06e5badb446fb8c97adb23c1da1e","fece65c6a132454e8dd761ecfaecfb5c","25eef5dfeade471ebd36f32f4ff7150e","9c1f2383354048acbfe9dae36736b2ce","a638ea0b3c0d40059cbac8d79a424b56","02fb907c303e49f493f1f87952dab4b4","a63aed56179d461680177cb9a974fe19","12af9089041e4685b8dcf99461f0531f","c01612bde1604f169ae5ee0d893f5fa0","d9dc47fd75fd4980bc67e6f562864eb3","1a463b7630164911a0c337adf5dbf678","97658862c8f5477380294312cb4ff988","58444e81cb99436fa63a8f2ea9a58e3b","426d87fb89c14d7a832b867b852deffa","23a24ed3d88944a2a941798f075fc061","cc21ee0070b64007bb6b54155343820a","be0ff407253c4e9fa35aac801a89232c","5fc0f1ab87ea4a4d92f9d49e2932d982","39cc0054452643df8db7fed02b6f3b09","07a32c5fba4342a78c423d1cf34aae34","e1aaed538123409a86eb48c713f97841","aef489c2dc0c4052be02bc7e2d923d3b","66d47f229a27458a89ec5571fe1d08dd","bf4707139bf54c709d0c7650cee11adc","db31cb912df744ac835e4fbcac40b138","1d2300d0aac947a49c502a0ce2a04acd","349ac33d169a4f54bf3b6aaa7bee98d9","1183317076cb4595b3fc89d0e8742e65","0c7fe5767ec645269d040e832fb3c32d","10d043b2c7644baf9805be850a29ac8b","9aca671b244b4ab8af0c76c065f38e0c","bcead4c069c94347b1f79b6a9a26ca67","074c59d7c92f411588b6489e082f17c3","31f3610803ca41b7b8b36a91bdbdd0a9","c5dea59def2d4f5e91ed3aba5b34ec00","eb6b3452f74042bbbaa328ec1486d83e","5649c6f5f68744abb37e8cb8d7d5c43a","3bbbfe134d374cbe9b6948b70b2e8763","cb54d0dee32842c99fb9235b87077a06","c42dc1a6614049308ac068053f97797d","9873f08a374c431ead91345caf9ffe89","27e290b459b84d1bb11aa49cb4c841fd","012a3e79a4c34f00b8e6131b3b1ab52d","3feaada9eaf34afeafef5a659740fc1d","ff4a52f9fdd748218541c6b6453e7b9c","e8b339ddaa774c8c909897cc6d95a239","8c177a741ab04f88b13dc549fe1efcfd","cbcae1e838d347d5b539836ae19c307c","4366c97a01bf4915b304b10f3d41e428","f5de5e06dead4a9ba856ec65ecf3bf33","35582cc558d1495e897d8686e8d8a9a9","0df05fdb2f894d5794973f487113b687","68a9450596144ba0a1b73ee8b7098a33","7f0856b7a6d24acd93adb94fe06b8589","cd06074114a84453bc3a7d5f3a9c3e9b","515acabe3525447fb5277b791df975f1","f08c6401d0d646e6ac031f7fb5260ff6","1ecde908b1944727b8bcbe675e4062db","5891e72ddab34ab99c1fe368fc98bf04","78d6db5df4f3474295bf72d1a463b255","e70f129d3c94498dbc23406d3a1245b5","beef4602994c4af2a1ccd03cc59acd98","9bfdba4d798447be9872b2abdc032833","a5b8fe74c3ca4b249e1f6cb216eea777","2099b8c2cdd442398ba74e4c385a8ff3","45be6ac2892c4b3199113c05d4ab121d","f3082845eec3488fb258c33b41f08665","3c426f95d90b4893b54eb5a4335fdff1","5eae8ac18fe7428da97a733bf252cb63","4b0ef49557dd44d9a9c31194d65e3361","1a2b8df3efc84f6c97594f902add9c39","08aad1da0e6c44cdb5a67a287e263fba","8aa5b39bf6984cbbba6fa4ebd7159fac","47c1555ecee74161a4c662d6ae42af64","cba928a17bd647fca80a582c23a646bf","edc0ba74860d49f2ada92604ce397b2f","3e4b5a89a5ff4096aecb65c055a9cf54","60564f9892bd4459883fdf1edbe5a784"]},"id":"W6L2VGKaChKG","executionInfo":{"status":"ok","timestamp":1619170301641,"user_tz":-60,"elapsed":51565,"user":{"displayName":"Runwei GUAN","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gig5aqYr4QYZZfEUwoKWtgQYID2W1OyboKlv0UK=s64","userId":"03438131955681400592"}},"outputId":"46e6f97f-db75-4647-9adc-08cceaa729f5"},"source":["class ImprovedRNN(nn.Module):\n","    def __init__(self, input_dim, embedding_dim, hidden_dim, output_dim):\n","        super().__init__()\n","        \n","        self.embedding = nn.Embedding(input_dim, embedding_dim)\n","        self.lstm = nn.LSTM(embedding_dim, hidden_dim)\n","        self.fc = nn.Linear(hidden_dim, output_dim)\n","        \n","    def forward(self, text, lengths):\n","        embedded = self.embedding(text)\n","        embedded = nn.utils.rnn.pack_padded_sequence(embedded, lengths.cpu())\n","        packed_output, (hn, cn) = self.lstm((embedded))\n","        return self.fc(cn.squeeze(0))\n","        \n","INPUT_DIM = len(TEXT.vocab)\n","EMBEDDING_DIM = 50\n","HIDDEN_DIM = 100\n","OUTPUT_DIM = 1\n","\n","imodel = ImprovedRNN(INPUT_DIM, EMBEDDING_DIM, HIDDEN_DIM, OUTPUT_DIM)\n","\n","# optimizer and loss function\n","optimizer = optim.Adam(imodel.parameters(), lr=0.01)\n","criterion = nn.BCEWithLogitsLoss()\n","torchbearer_trial = Trial(imodel, optimizer, criterion, metrics=['acc', 'loss']).to(device)\n","torchbearer_trial.with_generators(train_generator=MyIter(train_iterator), val_generator=MyIter(valid_iterator), test_generator=MyIter(test_iterator))\n","torchbearer_trial.run(epochs=5)\n","torchbearer_trial.predict()\n"],"execution_count":31,"outputs":[{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"bed5b132bddb4b568d19e52fa00f1d21","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, description='0/5(t)', max=274.0, style=ProgressStyle(description_width…"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"1abf13dc6fe1499f9b344f0294c7c5d4","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, description='0/5(v)', max=118.0, style=ProgressStyle(description_width…"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"a63aed56179d461680177cb9a974fe19","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, description='1/5(t)', max=274.0, style=ProgressStyle(description_width…"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"23a24ed3d88944a2a941798f075fc061","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, description='1/5(v)', max=118.0, style=ProgressStyle(description_width…"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"66d47f229a27458a89ec5571fe1d08dd","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, description='2/5(t)', max=274.0, style=ProgressStyle(description_width…"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"9aca671b244b4ab8af0c76c065f38e0c","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, description='2/5(v)', max=118.0, style=ProgressStyle(description_width…"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"cb54d0dee32842c99fb9235b87077a06","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, description='3/5(t)', max=274.0, style=ProgressStyle(description_width…"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"8c177a741ab04f88b13dc549fe1efcfd","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, description='3/5(v)', max=118.0, style=ProgressStyle(description_width…"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"cd06074114a84453bc3a7d5f3a9c3e9b","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, description='4/5(t)', max=274.0, style=ProgressStyle(description_width…"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"9bfdba4d798447be9872b2abdc032833","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, description='4/5(v)', max=118.0, style=ProgressStyle(description_width…"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"1a2b8df3efc84f6c97594f902add9c39","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, description='0/1(p)', max=391.0, style=ProgressStyle(description_width…"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n"],"name":"stdout"},{"output_type":"execute_result","data":{"text/plain":["tensor([[-19.5410],\n","        [ -9.5445],\n","        [ -9.1475],\n","        ...,\n","        [-14.1025],\n","        [ -6.8182],\n","        [ 22.9212]], device='cuda:0')"]},"metadata":{"tags":[]},"execution_count":31}]},{"cell_type":"markdown","metadata":{"id":"wZ_g4s_nChKG"},"source":["__What do you observe about the performance of this model? What would you do next if you wanted to improve it further? Write your answers in the box below:__"]},{"cell_type":"code","metadata":{"id":"5Y6TDmtTChKG","colab":{"base_uri":"https://localhost:8080/","height":371},"executionInfo":{"status":"error","timestamp":1619170313520,"user_tz":-60,"elapsed":676,"user":{"displayName":"Runwei GUAN","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gig5aqYr4QYZZfEUwoKWtgQYID2W1OyboKlv0UK=s64","userId":"03438131955681400592"}},"outputId":"c6b14b88-bd9d-4caa-ad9e-9afc9566fa4a"},"source":["# improvement method 1\n","class BetterRNN(nn.Module):\n","  def __init__(self, input_dim, embedding_dim, hidden_dim, output_dim):\n","    super.__init__()\n","    self.embedding = nn.Embedding(input_dim, embedding_dim)\n","    self.lstm = nn.LSTM(embedding_dim, hidden_dim)\n","    self.fc = nn.Linear(hidden_dim, output_dim)\n","  \n","  def forward(self, text, lengths):\n","    embedded = self.embedding(text)\n","    embedded = nn.utils.rnn.pack_padded_sequence(embedded, lengths.cpu())\n","    packed_output, (hn, cn) = self.lstm((embedded))\n","    return self.fc(cn.squeeze(0))\n","\n","\n","# hyperparameters\n","INPUT_DIM = len(TEXT.vocab)\n","EMBEDDING_DIM = 200\n","HIDDEN_DIM = 200\n","OUTPUT_DIM = 1\n","\n","# rnn model\n","better_model = BetterRNN(INPUT_DIM, EMBEDDING_DIM, HIDDEN_DIM, OUTPUT_DIM)\n","\n","# optimizer and loss function\n","optimizer = optim.Adam\n","\n"],"execution_count":32,"outputs":[{"output_type":"error","ename":"TypeError","evalue":"ignored","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mTypeError\u001b[0m                                 Traceback (most recent call last)","\u001b[0;32m<ipython-input-32-345bcf948cfd>\u001b[0m in \u001b[0;36m<module>\u001b[0;34m()\u001b[0m\n\u001b[1;32m     21\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     22\u001b[0m \u001b[0;31m# rnn model\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---> 23\u001b[0;31m \u001b[0mbetter_model\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mBetterRNN\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mINPUT_DIM\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mEMBEDDING_DIM\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mHIDDEN_DIM\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mOUTPUT_DIM\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m     24\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     25\u001b[0m \u001b[0;31m# optimizer and loss function\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m<ipython-input-32-345bcf948cfd>\u001b[0m in \u001b[0;36m__init__\u001b[0;34m(self, input_dim, embedding_dim, hidden_dim, output_dim)\u001b[0m\n\u001b[1;32m      2\u001b[0m \u001b[0;32mclass\u001b[0m \u001b[0mBetterRNN\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mnn\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mModule\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      3\u001b[0m   \u001b[0;32mdef\u001b[0m \u001b[0m__init__\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0minput_dim\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0membedding_dim\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mhidden_dim\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0moutput_dim\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m----> 4\u001b[0;31m     \u001b[0msuper\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m__init__\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m      5\u001b[0m     \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0membedding\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mnn\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mEmbedding\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0minput_dim\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0membedding_dim\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      6\u001b[0m     \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mlstm\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mnn\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mLSTM\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0membedding_dim\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mhidden_dim\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;31mTypeError\u001b[0m: descriptor '__init__' of 'super' object needs an argument"]}]},{"cell_type":"markdown","metadata":{"id":"D2Pi_DQzChKG"},"source":["## User Input\n","\n","We can now use our models to predict the sentiment of any sentence we give it. As it has been trained on movie reviews, the sentences provided should also be movie reviews.\n","\n","Our `predict_sentiment` function does a few things:\n","- tokenizes the sentence, i.e. splits it from a raw string into a list of tokens\n","- indexes the tokens by converting them into their integer representation from our vocabulary\n","- converts the indexes, which are a Python list into a PyTorch tensor\n","- add a batch dimension by `unsqueeze`ing \n","- squashes the output prediction from a real number between 0 and 1 with the `sigmoid` function\n","- converts the tensor holding a single value into an integer with the `item()` method\n","\n","We are expecting reviews with a negative sentiment to return a value close to 0 and positive reviews to return a value close to 1."]},{"cell_type":"code","metadata":{"id":"ggvFSrMnChKG","executionInfo":{"status":"ok","timestamp":1619170353855,"user_tz":-60,"elapsed":1506,"user":{"displayName":"Runwei GUAN","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gig5aqYr4QYZZfEUwoKWtgQYID2W1OyboKlv0UK=s64","userId":"03438131955681400592"}}},"source":["import spacy\n","nlp = spacy.load('en')\n","\n","\n","def predict_sentiment(model, sentence):\n","    tokenized = [tok.text for tok in nlp.tokenizer(sentence)]\n","    print(\"tokenized:\", tokenized)\n","    indexed = [TEXT.vocab.stoi[t] for t in tokenized]\n","    print(\"indexed:\", indexed)\n","    tensor = torch.LongTensor(indexed).to(device)\n","    tensor = tensor.unsqueeze(1)\n","    print(\"tensor:\", tensor)\n","    prediction = torch.sigmoid(model(tensor, torch.tensor([tensor.shape[0]])))\n","    return prediction.item()"],"execution_count":34,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"p5ez8j4sChKG"},"source":["An example negative review..."]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"tV5wnVzVChKH","executionInfo":{"status":"ok","timestamp":1619170356306,"user_tz":-60,"elapsed":936,"user":{"displayName":"Runwei GUAN","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gig5aqYr4QYZZfEUwoKWtgQYID2W1OyboKlv0UK=s64","userId":"03438131955681400592"}},"outputId":"e07e78ad-a87a-42c1-bc94-16c0f0f68607"},"source":["predict_sentiment(imodel, \"This film is terrible\")"],"execution_count":36,"outputs":[{"output_type":"stream","text":["tokenized: ['This', 'film', 'is', 'terrible']\n","indexed: [0, 25, 9, 421]\n","tensor: tensor([[  0],\n","        [ 25],\n","        [  9],\n","        [421]], device='cuda:0')\n"],"name":"stdout"},{"output_type":"execute_result","data":{"text/plain":["0.00758060859516263"]},"metadata":{"tags":[]},"execution_count":36}]},{"cell_type":"markdown","metadata":{"id":"nB7yvFBFChKH"},"source":["and an example positive review..."]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"SkA6a5MRChKH","executionInfo":{"elapsed":857,"status":"ok","timestamp":1618907599837,"user":{"displayName":"Runwei GUAN","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gig5aqYr4QYZZfEUwoKWtgQYID2W1OyboKlv0UK=s64","userId":"03438131955681400592"},"user_tz":-60},"outputId":"206516c2-c04c-44c0-f438-8ebdd6747f66"},"source":["predict_sentiment(imodel, \"This film is great and fantastic\")"],"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["0.9923447966575623"]},"metadata":{"tags":[]},"execution_count":32}]},{"cell_type":"markdown","metadata":{"id":"Dc2BegHyChKH"},"source":["__Use the box below to try classifying some of your own 'movie reviews':__"]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"6igNOqDDChKI","executionInfo":{"elapsed":670,"status":"ok","timestamp":1618907602561,"user":{"displayName":"Runwei GUAN","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gig5aqYr4QYZZfEUwoKWtgQYID2W1OyboKlv0UK=s64","userId":"03438131955681400592"},"user_tz":-60},"outputId":"1b2b0084-274e-4ccf-d05c-334a8040cba0"},"source":["predict_sentiment(imodel, \"This film makes me happy\")"],"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["0.9966553449630737"]},"metadata":{"tags":[]},"execution_count":33}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"63SUu62vxU8N","executionInfo":{"elapsed":888,"status":"ok","timestamp":1618907611558,"user":{"displayName":"Runwei GUAN","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gig5aqYr4QYZZfEUwoKWtgQYID2W1OyboKlv0UK=s64","userId":"03438131955681400592"},"user_tz":-60},"outputId":"35bdda96-7c5c-4a98-8116-e5c2ece115ba"},"source":["predict_sentiment(imodel, \"This film is fucking dam shit, it is nigger's favourite\")"],"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["0.9432370662689209"]},"metadata":{"tags":[]},"execution_count":34}]}]}